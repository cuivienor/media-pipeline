#!/bin/bash
# Mock mkvmerge - copies input to output instead of remuxing
# Handles: mkvmerge -o output.mkv input.mkv [track selections...]

OUTPUT=""
INPUT=""

while [[ $# -gt 0 ]]; do
    case "$1" in
        -o)
            OUTPUT="$2"
            shift 2
            ;;
        -J|--identify)
            # JSON identification mode
            echo '{"container":{"type":"Matroska"},"tracks":[{"id":0,"type":"video"},{"id":1,"type":"audio"}]}'
            exit 0
            ;;
        *.mkv)
            INPUT="$1"
            shift
            ;;
        *)
            shift
            ;;
    esac
done

if [ -n "$OUTPUT" ] && [ -n "$INPUT" ]; then
    mkdir -p "$(dirname "$OUTPUT")"
    cp "$INPUT" "$OUTPUT" 2>/dev/null || touch "$OUTPUT"
    echo "Mock: Created $OUTPUT"
fi
exit 0
